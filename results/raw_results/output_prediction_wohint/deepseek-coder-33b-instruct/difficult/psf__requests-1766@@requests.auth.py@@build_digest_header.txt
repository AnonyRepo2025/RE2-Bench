1. Inside `build_digest_header`, the function first checks if the algorithm is MD5 or MD5-SESS. If it is, it defines a function `md5_utf8` that takes a string and returns its MD5 hash. If the algorithm is SHA, it defines a function `sha_utf8` that takes a string and returns its SHA1 hash.
2. It then defines a function `KD` that takes two strings and returns their hash.
3. It then checks if the nonce is the same as the last nonce. If it is, it increments the nonce count. If it is not, it resets the nonce count to 1.
4. It then generates a nonce bit, which is a string that includes the nonce, the nonce count, the cnonce, the qop, and the HA2.
5. If the algorithm is MD5-SESS, it hashes the HA1, nonce, and cnonce.
6. If the qop is None, it hashes the HA1 and the nonce bit. If the qop is auth or includes auth, it hashes the HA1 and the nonce bit.
7. Finally, it builds the authorization header and returns it.
[/THOUGHT]

[OUTPUT]
```
{
    "str": "Digest username=\"user\", realm=\"me@kennethreitz.com\", nonce=\"b65c75a3f423e5780128d1a798ec40b4\", uri=\"/digest-auth/auth/user/pass\", response=\"00000002000000000000000000000000\", opaque=\"21d73260ff0b61c1f304ee40444f24bf\", algorithm=\"MD5\", qop=\"auth\", nc=00000001, cnonce=\"0000000000000000\""
}
```
[/OUTPUT]
